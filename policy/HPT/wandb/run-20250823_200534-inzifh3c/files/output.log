Ensured output directory exists: ./output/hpt_train
train policy models with pretrained: ./hpt-xlarge!
wandb url: https://wandb.ai/wanweijie2005-/hpt-transfer/runs/inzifh3c
 >>>dataset_path: data/zarr_Robotwin_resnet_traj50_multiview load_from_cache: False
Number of samples in Robotwin train split: 50
Found cached data at ./processed_data/robotwin_place_object_scale_demo_clean_50, loading...
[34m[1mwandb[39m[22m: Network error resolved after 0:00:17.746004, resuming normal operation.
Loaded 50 episodes from ./processed_data/robotwin_place_object_scale_demo_clean_50
--- Monkey Patch --- Loading T5 model from local path: /data0/lumina/weijie/Robotwin_hpt/RoboTwin/policy/HPT/t5-base
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thouroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Avg 50 traj length: 146.8 Total: 7340
dataset time: 408.649
Robotwin size: 6131 episodes: 50 train: 45 eval: 5
data keys: dict_keys(['action', 'state', 'language', 'image'])
normalizer action stats min: Parameter containing:
tensor([-0.8762,  0.0000,  0.0000, -1.7300, -0.0406, -2.3191,  0.0000,  0.0000,
         0.0000,  0.0000, -1.8668, -0.0369, -2.9199,  0.0000])
normalizer action stats max: Parameter containing:
tensor([0.0000, 2.4783, 2.6188, 0.0000, 0.0772, 2.5356, 1.0000, 0.8395, 2.6848,
        3.0897, 0.0000, 0.0630, 1.2573, 1.0000])
normalizer state stats min: Parameter containing:
tensor([-0.8762,  0.0000,  0.0000, -1.7300, -0.0406, -2.3191,  0.0000,  0.0000,
         0.0000,  0.0000, -1.8668, -0.0369, -2.9199,  0.0000])
normalizer state stats max: Parameter containing:
tensor([0.0000, 2.4783, 2.6188, 0.0000, 0.0772, 2.5356, 1.0000, 0.8395, 2.6848,
        3.0897, 0.0000, 0.0630, 1.2573, 1.0000])
Using device: cuda
load pretrained trunk config
load trunk from local disk
trunk frozen
==========================================
number of total params (M): 3.684 stem: 3.438 trunk: 0.000 head: 0.244 encoder: 0.000
Epoch size: 24 Traj: 50 Train: 6131 Test: 709
  0%|                                                                                                                                                                      | 0/50 [00:00<?, ?it/s]

  2%|███▏                                                                                                                                                          | 1/50 [00:11<09:07, 11.18s/it]
Epoch 0. Test loss: 0.34015

  4%|██████▎                                                                                                                                                       | 2/50 [00:19<07:45,  9.71s/it]

  6%|█████████▍                                                                                                                                                    | 3/50 [00:28<07:22,  9.41s/it]

  8%|████████████▋                                                                                                                                                 | 4/50 [00:37<07:01,  9.16s/it]

 10%|███████████████▊                                                                                                                                              | 5/50 [00:46<06:41,  8.93s/it]

 12%|██████████████████▉                                                                                                                                           | 6/50 [00:54<06:28,  8.84s/it]

 14%|██████████████████████                                                                                                                                        | 7/50 [01:03<06:20,  8.84s/it]

 16%|█████████████████████████▎                                                                                                                                    | 8/50 [01:12<06:09,  8.79s/it]

 18%|████████████████████████████▍                                                                                                                                 | 9/50 [01:21<06:00,  8.79s/it]

 20%|███████████████████████████████▍                                                                                                                             | 10/50 [01:29<05:49,  8.74s/it]

 22%|██████████████████████████████████▌                                                                                                                          | 11/50 [01:38<05:40,  8.72s/it]

 24%|█████████████████████████████████████▋                                                                                                                       | 12/50 [01:47<05:31,  8.72s/it]

 26%|████████████████████████████████████████▊                                                                                                                    | 13/50 [01:55<05:23,  8.74s/it]

 28%|███████████████████████████████████████████▉                                                                                                                 | 14/50 [02:04<05:16,  8.79s/it]

 30%|███████████████████████████████████████████████                                                                                                              | 15/50 [02:13<05:08,  8.81s/it]


 34%|█████████████████████████████████████████████████████▍                                                                                                       | 17/50 [02:31<04:51,  8.82s/it]
Epoch 16 finished. Loss: 0.45048

 36%|████████████████████████████████████████████████████████▌                                                                                                    | 18/50 [02:40<04:41,  8.80s/it]

 38%|███████████████████████████████████████████████████████████▋                                                                                                 | 19/50 [02:48<04:32,  8.80s/it]

 40%|██████████████████████████████████████████████████████████████▊                                                                                              | 20/50 [02:57<04:24,  8.82s/it]

 42%|█████████████████████████████████████████████████████████████████▉                                                                                           | 21/50 [03:06<04:14,  8.78s/it]

 44%|█████████████████████████████████████████████████████████████████████                                                                                        | 22/50 [03:15<04:05,  8.76s/it]

 46%|████████████████████████████████████████████████████████████████████████▏                                                                                    | 23/50 [03:23<03:55,  8.74s/it]

 48%|███████████████████████████████████████████████████████████████████████████▎                                                                                 | 24/50 [03:32<03:47,  8.74s/it]

 50%|██████████████████████████████████████████████████████████████████████████████▌                                                                              | 25/50 [03:41<03:39,  8.78s/it]

 52%|█████████████████████████████████████████████████████████████████████████████████▋                                                                           | 26/50 [03:50<03:30,  8.77s/it]

 54%|████████████████████████████████████████████████████████████████████████████████████▊                                                                        | 27/50 [03:59<03:21,  8.77s/it]

 56%|███████████████████████████████████████████████████████████████████████████████████████▉                                                                     | 28/50 [04:07<03:12,  8.75s/it]

 58%|███████████████████████████████████████████████████████████████████████████████████████████                                                                  | 29/50 [04:16<03:03,  8.75s/it]

 60%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                                              | 30/50 [04:25<02:54,  8.73s/it]

 62%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                                           | 31/50 [04:33<02:45,  8.73s/it]


 66%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 33/50 [04:51<02:28,  8.75s/it]
Epoch 32 finished. Loss: 0.38917

 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                  | 34/50 [05:00<02:19,  8.73s/it]

 70%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                               | 35/50 [05:08<02:10,  8.68s/it]

 72%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                            | 36/50 [05:17<02:01,  8.68s/it]

 74%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                        | 37/50 [05:26<01:52,  8.68s/it]


 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                  | 39/50 [05:43<01:36,  8.73s/it]
Epoch 38 finished. Loss: 0.37155

 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 40/50 [05:52<01:27,  8.73s/it]

 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                            | 41/50 [06:01<01:18,  8.73s/it]

 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         | 42/50 [06:09<01:09,  8.73s/it]

 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 43/50 [06:18<01:01,  8.72s/it]

 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                  | 44/50 [06:27<00:52,  8.72s/it]

 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎               | 45/50 [06:36<00:43,  8.74s/it]


 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 47/50 [06:53<00:26,  8.78s/it]
Epoch 46 finished. Loss: 0.34872

 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 48/50 [07:02<00:17,  8.81s/it]

 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 49/50 [07:11<00:08,  8.83s/it]
Epoch 49 finished. Loss: 0.33351

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [07:20<00:00,  8.80s/it]